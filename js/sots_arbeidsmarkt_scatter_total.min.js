function createScatterLegend(){var e=15,r=25,t=250,n=scatterLegend.append("g").attr("class","legendWrapper").attr("transform","translate(0,0)"),a=n.selectAll(".scatterLegendSquare").data(sectorColor.range()).enter().append("g").attr("class","scatterLegendSquare").attr("width",scatterLegendWidth).attr("height",r).attr("transform",function(e,t){return"translate(0,"+t*r+")"}).style("cursor","pointer").on("mouseover",sectorSelect(.02)).on("mouseout",sectorSelect(.7)).on("click",sectorClick);a.append("rect").attr("width",t).attr("height",r).attr("transform","translate("+-t/2+",0)").style("fill","white"),a.append("rect").attr("width",e).attr("height",e).attr("transform","translate("+-t/2+",0)").style("fill",function(e){return e}),a.append("text").attr("transform","translate("+(-t/2+e+8)+","+e/2+")").attr("class","legendText").style("text-anchor","start").attr("dy",".30em").style("font-size","11px").text(function(e,r){return sectorColor.domain()[r]})}function sectorClick(e,r){event.stopPropagation(),d3.selectAll(".scatterLegendSquare").on("mouseover",null).on("mouseout",null);var t=sectorColor.domain()[r];scatterNL.selectAll("circle.NL").style("opacity",.7).style("visibility",function(e){return e.Baan_sector!=t?"hidden":"visible"}),scatterNL.selectAll(".voronoi.NL").on("mouseover",function(e,r){return e.Baan_sector!=t?null:showScatterTooltip.call(this,e,r)}).on("mouseout",function(e,r){return e.Baan_sector!=t?null:removeScatterTooltip.call(this,e,r)})}function resetClick(){d3.selectAll(".scatterLegendSquare").on("mouseover",sectorSelect(.02)).on("mouseout",sectorSelect(.7)),scatterNL.selectAll("circle.NL").style("opacity",.7).style("visibility","visible"),scatterNL.selectAll(".voronoi.NL").on("mouseover",showScatterTooltip).on("mouseout",function(e,r){removeScatterTooltip.call(this,e,r)})}function removeScatterTooltip(e){var r=d3.selectAll(".circle.NL."+e.BeroepClass);r.style("opacity",.7),$(".popover").each(function(){$(this).remove()}),d3.selectAll(".guide").transition().duration(200).style("opacity",0).remove()}function showScatterTooltip(e){var r=".dataresource.scatterNL",t=scatterNL,n=d3.selectAll(".circle.NL."+e.BeroepClass);$(n).popover({placement:"auto top",container:r,trigger:"manual",html:!0,content:function(){return"<span style='font-size: 11px; text-align: center;'>"+e.Beroep+"</span>"}}),$(n).popover("show"),n.style("opacity",1),t.append("g").attr("class","guide").append("line").attr("x1",n.attr("cx")).attr("x2",n.attr("cx")).attr("y1",+n.attr("cy")).attr("y2",scatterHeight).style("stroke",n.style("fill")).style("opacity",0).style("pointer-events","none").transition().duration(400).style("opacity",.5),t.append("g").attr("class","guide").append("line").attr("x1",+n.attr("cx")).attr("x2",0).attr("y1",n.attr("cy")).attr("y2",n.attr("cy")).style("stroke",n.style("fill")).style("opacity",0).style("pointer-events","none").transition().duration(400).style("opacity",.5)}function sectorSelect(e){return function(r,t){var n=sectorColor.domain()[t];scatterNL.selectAll("circle.NL").filter(function(e){return e.Baan_sector!=n}).transition().style("opacity",e)}}function drawScatter(e,r,t,n,a){var s=d3.scale.linear().range([0,t]).domain([0,1]).nice(),i=d3.svg.axis().orient("bottom").ticks(5).tickFormat(numFormatPercent).scale(s);r.append("g").attr("class","x axis").attr("transform","translate(0,"+n+")").call(i);var o=d3.scale.linear().range([n,0]).domain([0,.75]).nice(),c=d3.svg.axis().orient("left").ticks(4).tickFormat(numFormatPercent).scale(o);r.append("g").attr("class","y axis").attr("transform","translate(0,0)").call(c),r.append("line").attr("class","trendline").attr("x1",s(.05)).attr("y1",o(.10259)).attr("x2",s(.95)).attr("y2",o(.46655)),r.selectAll("circle").data(e.sort(function(e,r){return r.Perc_Werkenden>e.Perc_Werkenden})).enter().append("circle").attr("class",function(e){return"circle NL "+e.BeroepClass}).style("opacity",.7).style("fill",function(e){return sectorColor(e.Baan_sector)}).attr("cx",function(e){return s(e.Robotiseringskans)}).attr("cy",function(e){return o(e.Perc_Werkzoekenden)}).attr("r",function(e){return rScale(e.Perc_Werkenden)}).style("pointer-events","none");var l=d3.geom.voronoi().x(function(e){return s(e.Robotiseringskans)}).y(function(e){return o(e.Perc_Werkzoekenden)}).clipExtent([[0,0],[t,n]]),d=r.append("g").attr("class","voronoi");d.selectAll("path").data(l(e)).enter().append("path").attr("d",function(e){return"M"+e.join("L")+"Z"}).datum(function(e){return e.point}).attr("class",function(e){return"voronoi NL "+e.BeroepClass}).on("mouseover",showScatterTooltip).on("mouseout",function(e,r){removeScatterTooltip.call(this,e,r)}),r.append("g").append("text").attr("class","x axis label").attr("text-anchor","middle").attr("transform","translate("+t/2+","+(n+40)+")").style("font-size","10px").text("Kans op Robotisering"),r.append("g").append("text").attr("class","y axis label").attr("text-anchor","middle").attr("x",0).attr("y",0).attr("dy","0.35em").attr("transform","translate(0,"+7*-a.top/8+")").style("font-size","10px").text("% werkzoekenden t.o.v. werkenden").call(wrap,2*a.left)}function bubbleLegend(e,r,t,n){var a=t[0],s=t[1],i=0,o=50,c=25,l=5;e.append("text").attr("class","legendTitle").attr("transform","translate("+i+",-14)").attr("x","0px").attr("y","0px").attr("dy","1em").text(n).call(wrap,100),e.append("circle").attr("r",r(a)).attr("class","legendCircle").attr("cx",i).attr("cy",o-r(a)),e.append("circle").attr("r",r(s)).attr("class","legendCircle").attr("cx",i).attr("cy",o-r(s)),e.append("line").attr("class","legendLine").attr("x1",i).attr("y1",o-2*r(a)).attr("x2",i+c).attr("y2",o-2*r(a)),e.append("line").attr("class","legendLine").attr("x1",i).attr("y1",o-2*r(s)).attr("x2",i+c).attr("y2",o-2*r(s)),e.append("text").attr("class","legendText").attr("x",i+c+l).attr("y",o-2*r(a)).attr("dy","0.25em").text(Math.round(100*a)+"%"),e.append("text").attr("class","legendText").attr("x",i+c+l).attr("y",o-2*r(s)).attr("dy","0.25em").text(Math.round(100*s)+"%")}var mobileScreen=$(window).width()>400?!1:!0,scatterMargin={left:50,top:50,right:20,bottom:50},scatterWidth=Math.min($(".dataresource.scatterNL").width(),800)-scatterMargin.left-scatterMargin.right,scatterHeight=2*scatterWidth/3,scatterLegendMargin={left:0,top:10,right:0,bottom:10},scatterLegendWidth=$(".dataresource.scatterLegend").width()-scatterLegendMargin.left-scatterLegendMargin.right,scatterLegendHeight=310,svgScatterNL=d3.select(".dataresource.scatterNL").append("svg").attr("width",scatterWidth+scatterMargin.left+scatterMargin.right).attr("height",scatterHeight+scatterMargin.top+scatterMargin.bottom),svgScatterLegend=d3.select(".dataresource.scatterLegend").append("svg").attr("width",scatterLegendWidth+scatterLegendMargin.left+scatterLegendMargin.right).attr("height",scatterLegendHeight+scatterLegendMargin.top+scatterLegendMargin.bottom),scatterNL=svgScatterNL.append("g").attr("class","chartNL").attr("transform","translate("+scatterMargin.left+","+scatterMargin.top+")"),scatterLegend=svgScatterLegend.append("g").attr("class","legendWrapper").attr("transform","translate("+(scatterLegendWidth/2+scatterLegendMargin.left)+","+scatterLegendMargin.top+")");d3.select(".scatterArbeidsmarkt").on("click",resetClick);var banen=[{Beroep:"Administratieve medewerkers",BeroepClass:"administratieve_medewerkers",Baan_sector:"Administratief personeel",Robotiseringskans:.87061,Perc_Werkzoekenden:.340792134831461,Perc_Werkenden:.0254322046006572},{Beroep:"Ambachtslieden en drukkerijmedewerkers",BeroepClass:"ambachtslieden_en_drukkerijmedewerkers",Baan_sector:"Ambachtslieden",Robotiseringskans:.4492,Perc_Werkzoekenden:.248466666666667,Perc_Werkenden:.0042863266180883},{Beroep:"Ander administratief personeel",BeroepClass:"ander_administratief_personeel",Baan_sector:"Administratief personeel",Robotiseringskans:.64372,Perc_Werkzoekenden:.688787878787879,Perc_Werkenden:.0141448778396914},{Beroep:"Assembleurs",BeroepClass:"assembleurs",Baan_sector:"Overig",Robotiseringskans:.80729,Perc_Werkzoekenden:.324052631578947,Perc_Werkenden:.00271467352478926},{Beroep:"Assistenten bij de bereiding van levensmiddelen",BeroepClass:"assistenten_bij_de_bereiding_van_levensmiddelen",Baan_sector:"Elementaire beroepen",Robotiseringskans:.7998,Perc_Werkzoekenden:.321592592592593,Perc_Werkenden:.00385769395627947},{Beroep:"Bedieningspersoneel van stationaire machines en installaties",BeroepClass:"bedieningspersoneel_van_stationaire_machines_en_installaties",Baan_sector:"Overig",Robotiseringskans:.71562,Perc_Werkzoekenden:.176630769230769,Perc_Werkenden:.00928704100585798},{Beroep:"Bestuurders van voertuigen en bedieningspersoneel van mobiele installaties",BeroepClass:"bestuurders_van_voertuigen_en_bedieningspersoneel_van_mobiele_installaties",Baan_sector:"Overig",Robotiseringskans:.60706,Perc_Werkzoekenden:.357601769911504,Perc_Werkenden:.0322903271895985},{Beroep:"Boekhoudkundige medewerkers en voorraadbeheerders",BeroepClass:"boekhoudkundige_medewerkers_en_voorraadbeheerders",Baan_sector:"Administratief personeel",Robotiseringskans:.84775,Perc_Werkzoekenden:.246552727272727,Perc_Werkenden:.0392913273324761},{Beroep:"Bouwarbeiders, m.u.v. elektriciens",BeroepClass:"bouwarbeiders_m_u_v_elektriciens",Baan_sector:"Ambachtslieden",Robotiseringskans:.52882,Perc_Werkzoekenden:.35720564516129,Perc_Werkenden:.0354336333761966},{Beroep:"Directeuren van grote ondernemingen, beleidvoerende functies, leden van wetgevende lichamen",BeroepClass:"directeuren_van_grote_ondernemingen_beleidvoerende_functies_leden_van_wetgevende_lichamen",Baan_sector:"Leidinggevende functies",Robotiseringskans:.07876,Perc_Werkzoekenden:.0646263736263736,Perc_Werkenden:.0130018574082012},{Beroep:"Elektriciens en elektronicamonteurs",BeroepClass:"elektriciens_en_elektronicamonteurs",Baan_sector:"Ambachtslieden",Robotiseringskans:.42491,Perc_Werkzoekenden:.216577464788732,Perc_Werkenden:.0101443063294756},{Beroep:"Huishoudelijke hulpen en schoonmakers",BeroepClass:"huishoudelijke_hulpen_en_schoonmakers",Baan_sector:"Elementaire beroepen",Robotiseringskans:.54824,Perc_Werkzoekenden:.479563953488372,Perc_Werkenden:.0245749392770396},{Beroep:"Juristen, sociaal-wetenschappers en scheppende en uitvoerende kunstenaars",BeroepClass:"juristen_sociaal_wetenschappers_en_scheppende_en_uitvoerende_kunstenaars",Baan_sector:"Juridisch en culturele (vak)specialisten",Robotiseringskans:.13201,Perc_Werkzoekenden:.159272401433692,Perc_Werkenden:.0398628375482212},{Beroep:"Klanten bedienend personeel",BeroepClass:"klanten_bedienend_personeel",Baan_sector:"Administratief personeel",Robotiseringskans:.46822,Perc_Werkzoekenden:.420590277777778,Perc_Werkenden:.0205743677668238},{Beroep:"Leidinggevende functies in het hotel  en restaurantwezen, in de detail- en groothandel en op het gebied van andere diensten",BeroepClass:"leidinggevende_functies_in_het_hotel_en_restaurantwezen_in_de_detail_en_groothandel_en_op_het_gebied_van_andere_diensten",Baan_sector:"Leidinggevende functies",Robotiseringskans:.10671,Perc_Werkzoekenden:.207107142857143,Perc_Werkenden:.0120017145306472},{Beroep:"Leidinggevende functies op administratief en commercieel gebied",BeroepClass:"leidinggevende_functies_op_administratief_en_commercieel_gebied",Baan_sector:"Leidinggevende functies",Robotiseringskans:.13804,Perc_Werkzoekenden:.234223076923077,Perc_Werkenden:.018574082011716},{Beroep:"Leidinggevende functies op het gebied van productie en gespecialiseerde diensten",BeroepClass:"leidinggevende_functies_op_het_gebied_van_productie_en_gespecialiseerde_diensten",Baan_sector:"Leidinggevende functies",Robotiseringskans:.08334,Perc_Werkzoekenden:.119322916666667,Perc_Werkenden:.0274324903557651},{Beroep:"Metaalarbeiders, machinemonteurs e.d.",BeroepClass:"metaalarbeiders_machinemonteurs_e_d",Baan_sector:"Ambachtslieden",Robotiseringskans:.61962,Perc_Werkzoekenden:.196913513513514,Perc_Werkenden:.0264323474782112},{Beroep:"Onderwijsgevenden",BeroepClass:"onderwijsgevenden",Baan_sector:"Onderwijsgevenden",Robotiseringskans:.06365,Perc_Werkzoekenden:.0915504087193461,Perc_Werkenden:.0524360622946135},{Beroep:"Ongeschoolde arbeiders in de land- en bosbouw en de visserij",BeroepClass:"ongeschoolde_arbeiders_in_de_land_en_bosbouw_en_de_visserij",Baan_sector:"Elementaire beroepen",Robotiseringskans:.82936,Perc_Werkzoekenden:.163909090909091,Perc_Werkenden:.00314330618659809},{Beroep:"Specialisten op het gebied van bedrijfsbeheer en administratie",BeroepClass:"specialisten_op_het_gebied_van_bedrijfsbeheer_en_administratie",Baan_sector:"Bedrijfsbeheer (vak)specialisten",Robotiseringskans:.22838,Perc_Werkzoekenden:.120633196721311,Perc_Werkenden:.069724246320903},{Beroep:"Specialisten op het gebied van de gezondheidszorg",BeroepClass:"specialisten_op_het_gebied_van_de_gezondheidszorg",Baan_sector:"Gezondheidszorg (vak)specialisten",Robotiseringskans:.03608,Perc_Werkzoekenden:.0454480286738351,Perc_Werkenden:.0398628375482212},{Beroep:"Specialisten op het gebied van informatie- en communicatietechnologie",BeroepClass:"specialisten_op_het_gebied_van_informatie_en_communicatietechnologie",Baan_sector:"IT (vak)specialisten",Robotiseringskans:.08693,Perc_Werkzoekenden:.0704813278008299,Perc_Werkenden:.0344334904986427},{Beroep:"Technici op het gebied van informatie en communicatie",BeroepClass:"technici_op_het_gebied_van_informatie_en_communicatie",Baan_sector:"IT (vak)specialisten",Robotiseringskans:.38481,Perc_Werkzoekenden:.203085106382979,Perc_Werkenden:.006715245035005},{Beroep:"Vakspecialisten op het gebied van bedrijfsbeheer en administratie",BeroepClass:"vakspecialisten_op_het_gebied_van_bedrijfsbeheer_en_administratie",Baan_sector:"Bedrijfsbeheer (vak)specialisten",Robotiseringskans:.38671,Perc_Werkzoekenden:.144696356275304,Perc_Werkenden:.0705815116445206},{Beroep:"Vakspecialisten op het gebied van de gezondheidszorg",BeroepClass:"vakspecialisten_op_het_gebied_van_de_gezondheidszorg",Baan_sector:"Gezondheidszorg (vak)specialisten",Robotiseringskans:.2496,Perc_Werkzoekenden:.089035,Perc_Werkenden:.0285755107872553},{Beroep:"Vakspecialisten op het gebied van wetenschap en techniek",BeroepClass:"vakspecialisten_op_het_gebied_van_wetenschap_en_techniek",Baan_sector:"Wetenschap en techniek (vak)specialisten",Robotiseringskans:.35602,Perc_Werkzoekenden:.131574468085106,Perc_Werkenden:.02686098014002},{Beroep:"Vakspecialisten op juridisch, maatschappelijk en cultureel gebied",BeroepClass:"vakspecialisten_op_juridisch_maatschappelijk_en_cultureel_gebied",Baan_sector:"Juridisch en culturele (vak)specialisten",Robotiseringskans:.24111,Perc_Werkzoekenden:.203688524590164,Perc_Werkenden:.0348621231604515},{Beroep:"Veiligheidswerkers",BeroepClass:"veiligheidswerkers",Baan_sector:"Overig",Robotiseringskans:.26725,Perc_Werkzoekenden:.199097826086957,Perc_Werkenden:.0131447349621374},{Beroep:"Verkopers",BeroepClass:"verkopers",Baan_sector:"Verkopers en verleners persoonlijke diensten",Robotiseringskans:.5252,Perc_Werkzoekenden:.256377870563674,Perc_Werkenden:.0684383483354765},{Beroep:"Verleners persoonlijke diensten",BeroepClass:"verleners_persoonlijke_diensten",Baan_sector:"Verkopers en verleners persoonlijke diensten",Robotiseringskans:.35062,Perc_Werkzoekenden:.228630363036304,Perc_Werkenden:.0432918988426918},{Beroep:"Verzorgend personeel",BeroepClass:"verzorgend_personeel",Baan_sector:"Verzorgend personeel",Robotiseringskans:.35653,Perc_Werkzoekenden:.249832817337461,Perc_Werkenden:.0461494499214173},{Beroep:"Voedselverwerkende beroepen, houtwerkers, kleermakers en andere ambachtslieden",BeroepClass:"voedselverwerkende_beroepen_houtwerkers_kleermakers_en_andere_ambachtslieden",Baan_sector:"Ambachtslieden",Robotiseringskans:.52815,Perc_Werkzoekenden:.20409756097561,Perc_Werkenden:.0117159594227747},{Beroep:"Voor de markt producerende geschoolde landbouwers",BeroepClass:"voor_de_markt_producerende_geschoolde_landbouwers",Baan_sector:"Overig",Robotiseringskans:.58426,Perc_Werkzoekenden:.173822222222222,Perc_Werkenden:.0192884697813973},{Beroep:"Vuilnisophalers en -verwerkers en andere elementaire beroepen",BeroepClass:"vuilnisophalers_en_verwerkers_en_andere_elementaire_beroepen",Baan_sector:"Elementaire beroepen",Robotiseringskans:.56913,Perc_Werkzoekenden:.141529411764706,Perc_Werkenden:.00485783683383341},{Beroep:"Wetenschappers en ingenieurs",BeroepClass:"wetenschappers_en_ingenieurs",Baan_sector:"Wetenschap en techniek (vak)specialisten",Robotiseringskans:.09619,Perc_Werkzoekenden:.125357142857143,Perc_Werkenden:.0300042863266181}],rScale=d3.scale.sqrt().range([0,mobileScreen?12:20]).domain([0,.1]),sectorColor=d3.scale.ordinal().range(["#EFB605","#E79B01","#E35B0F","#DD092D","#C50046","#A70A61","#892E83","#604BA2","#2D6AA6","#089384","#25AE64","#7EB852","#C4C4C4"]).domain(["Administratief personeel","Ambachtslieden","Leidinggevende functies","Elementaire beroepen","Juridisch en culturele (vak)specialisten","Onderwijsgevenden","Bedrijfsbeheer (vak)specialisten","Gezondheidszorg (vak)specialisten","IT (vak)specialisten","Wetenschap en techniek (vak)specialisten","Verkopers en verleners persoonlijke diensten","Verzorgend personeel","Overig"]);drawScatter(data=banen,wrapper=scatterNL,width=scatterWidth,height=scatterHeight,margin=scatterMargin),createScatterLegend();var legendCircle=scatterNL.append("g").attr("class","legendWrapper").attr("transform","translate(50,10)");legendCircle.append("text").attr("class","legendTitle").attr("transform","translate(0,-14)").attr("x","0px").attr("y","0px").attr("dy","1em").text("Elke cirkel is een Beroep").call(wrap,90),legendCircle.append("circle").attr("r",rScale(.06)).attr("class","legendCircle").attr("cx",0).attr("cy",50-rScale(.06));var bubbleSizeLegend=scatterNL.append("g").attr("class","legendWrapper").attr("transform","translate(140,10)");bubbleLegend(bubbleSizeLegend,rScale,legendSizes=[.02,.06],legendName="Relatieve aandeel werkenden");